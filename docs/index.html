<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An R package for diagnosis and meta-analysis of hard-to-reach population measurement studies • hiddenmeta</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="An R package for diagnosis and meta-analysis of hard-to-reach population measurement studies">
<meta property="og:description" content="Package provides a number of tools for simulation of population, sampling and estimation of size and pervalence of hard-to-reach populations. It relies on the MIDA approach proposed in DeclareDesign package">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">hiddenmeta</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="vignettes/hiddenmeta-base.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="hiddenmeta-r-codecov-license-mit" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#hiddenmeta-r-codecov-license-mit" class="anchor"></a>hiddenmeta <img src="https://github.com/gerasy1987/hiddenmeta/workflows/R/badge.svg" alt="R"><a href="https://codecov.io/gh/gerasy1987/hiddenmeta"><img src="https://codecov.io/gh/gerasy1987/hiddenmeta/branch/main/graph/badge.svg?token=ZG9A64Q0A1" alt="codecov"></a> <a href="https://github.com/gerasy1987/hiddenmeta/blob/main/LICENSE"><img src="https://img.shields.io/badge/License-MIT-yellow.svg" alt="License: MIT"></a>
</h1></div>
<div id="install-and-load-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#install-and-load-packages" class="anchor"></a>Install and load packages</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"DeclareDesign"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"igraph"</span><span class="op">)</span>

<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"gerasy1987/hiddenmeta"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">hiddenmeta</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://declaredesign.org/r/declaredesign/">DeclareDesign</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://igraph.org">igraph</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="step-1-provide-study-design-features" class="section level2">
<h2 class="hasAnchor">
<a href="#step-1-provide-study-design-features" class="anchor"></a>Step 1. Provide study design features</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## STUDY 1</span>
<span class="va">study_1</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    pop <span class="op">=</span> 
      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        handler <span class="op">=</span> <span class="va">get_study_population</span>,
        
        <span class="co"># network structure setup</span>
        network_handler <span class="op">=</span> <span class="va">sim_block_network</span>,
        network_handler_args <span class="op">=</span> 
          <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">2000</span>, K <span class="op">=</span> <span class="fl">2</span>, prev_K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>known <span class="op">=</span> <span class="fl">.3</span>, hidden <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>, rho_K <span class="op">=</span> <span class="fl">.05</span>,
               p_edge_within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>known <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span>, hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span>,
               p_edge_between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>known <span class="op">=</span> <span class="fl">0.05</span>, hidden <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>,
               directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,
        
        <span class="co"># groups</span>
        group_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"known"</span>, <span class="st">"hidden"</span><span class="op">)</span>,
        
        <span class="co"># probability of visibility (show-up) for each group</span>
        p_visible <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>known <span class="op">=</span> <span class="fl">1</span>, hidden <span class="op">=</span> <span class="fl">.7</span><span class="op">)</span>,
        
        <span class="co"># probability of service utilization in hidden population</span>
        <span class="co"># for service multiplier</span>
        add_groups <span class="op">=</span> 
          <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>service_use <span class="op">=</span> <span class="st">"rbinom(n(), 1, 0.25 + hidden * 0.05)"</span>,
         <span class="st">"purrr::map_df(hidden, ~ sapply( `names&lt;-`(c(.2, .1, .3, .2), paste0('loc_', 1:4)), function(add) rbinom(length(.x), 1, 0.1 + .x * add)))"</span>,
         known_2 <span class="op">=</span> <span class="fl">0.1</span>, known_3 <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>
      <span class="op">)</span>,
    sample <span class="op">=</span> 
      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        rds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">sample_rds</span>,
                   <span class="co"># RDS parameters</span>
                   sampling_variable <span class="op">=</span> <span class="st">"rds"</span>,
                   n_seed <span class="op">=</span> <span class="fl">20</span>,
                   n_coupons <span class="op">=</span> <span class="fl">3</span>,
                   target_type <span class="op">=</span> <span class="st">"sample"</span>,
                   target_n_rds <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,
        tls <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">sample_tls</span>,
                   sampling_variable <span class="op">=</span> <span class="st">"tls"</span>,
                   <span class="co"># TLS sampling parameters</span>
                   target_n_clusters <span class="op">=</span> <span class="fl">3</span>,
                   target_n_tls <span class="op">=</span> <span class="fl">100</span>,
                   cluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"loc_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span>,
        pps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">sample_pps</span>,
                   sampling_variable <span class="op">=</span> <span class="st">"pps"</span>,
                   <span class="co"># prop sampling parameters</span>
                   sampling_frame <span class="op">=</span> <span class="cn">NULL</span>,
                   strata <span class="op">=</span> <span class="cn">NULL</span>,
                   cluster <span class="op">=</span> <span class="cn">NULL</span>,
                   target_n_pps <span class="op">=</span> <span class="fl">400</span><span class="op">)</span>
      <span class="op">)</span>,
    inquiries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">get_study_estimands</span>,
                     known_pattern <span class="op">=</span> <span class="st">"^known"</span>, 
                     hidden_pattern <span class="op">=</span> <span class="st">"^hidden$"</span><span class="op">)</span>,
    estimators <span class="op">=</span> 
      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        rds <span class="op">=</span> 
          <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>sspse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">get_study_est_sspse</span>,
                            prior_mean <span class="op">=</span> <span class="fl">200</span>,
                            mcmc_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>interval <span class="op">=</span> <span class="fl">5</span>, burnin <span class="op">=</span> <span class="fl">2000</span>, samplesize <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>,
                            rds_prefix <span class="op">=</span> <span class="st">"rds"</span>, 
                            label <span class="op">=</span> <span class="st">"rds_sspse"</span><span class="op">)</span>,
               chords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">get_study_est_chords</span>, 
                             type <span class="op">=</span> <span class="st">"mle"</span>,
                             seed_condition <span class="op">=</span> <span class="st">"rds_from == -999"</span>,
                             n_boot <span class="op">=</span> <span class="fl">100</span>,
                             rds_prefix <span class="op">=</span> <span class="st">"rds"</span>,
                             label <span class="op">=</span> <span class="st">"rds_chords"</span><span class="op">)</span>,
               multiplier <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">get_study_est_multiplier</span>, 
                                 service_var <span class="op">=</span> <span class="st">"service_use"</span>,
                                 seed_condition <span class="op">=</span> <span class="st">"rds_from == -999"</span>,
                                 n_boot <span class="op">=</span> <span class="fl">100</span>,
                                 rds_prefix <span class="op">=</span> <span class="st">"rds"</span>,
                                 label <span class="op">=</span> <span class="st">"rds_multi"</span><span class="op">)</span><span class="op">)</span>,
        tls <span class="op">=</span>
          <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>ht <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">get_study_est_ht</span>,
                         prefix <span class="op">=</span> <span class="st">"tls"</span>,
                         label <span class="op">=</span> <span class="st">"tls_ht"</span><span class="op">)</span>,
               nsum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">get_study_est_nsum</span>,
                           known <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"known"</span>, <span class="st">"known_2"</span>, <span class="st">"known_3"</span><span class="op">)</span>,
                           hidden <span class="op">=</span> <span class="st">"hidden_visible_out"</span>,
                           survey_design <span class="op">=</span> <span class="op">~</span> <span class="va">tls_cluster</span>,
                           n_boot <span class="op">=</span> <span class="fl">100</span>,
                           prefix <span class="op">=</span> <span class="st">"tls"</span>,
                           label <span class="op">=</span> <span class="st">"tls_nsum"</span><span class="op">)</span><span class="op">)</span>,
        pps <span class="op">=</span> 
          <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>ht <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">get_study_est_ht</span>,
                         prefix <span class="op">=</span> <span class="st">"pps"</span>,
                         label <span class="op">=</span> <span class="st">"pps_ht"</span><span class="op">)</span>,
               nsum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">get_study_est_nsum</span>,
                           known <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"known"</span>, <span class="st">"known_2"</span>, <span class="st">"known_3"</span><span class="op">)</span>,
                           hidden <span class="op">=</span> <span class="st">"hidden_visible_out"</span>,
                           survey_design <span class="op">=</span> <span class="op">~</span> <span class="va">pps_cluster</span> <span class="op">+</span> <span class="fu">strata</span><span class="op">(</span><span class="va">pps_strata</span><span class="op">)</span>,
                           n_boot <span class="op">=</span> <span class="fl">100</span>,
                           prefix <span class="op">=</span> <span class="st">"pps"</span>,
                           label <span class="op">=</span> <span class="st">"pps_nsum"</span><span class="op">)</span><span class="op">)</span>,
        all <span class="op">=</span> 
          <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>recap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">get_study_est_recapture</span>,
                            capture_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"loc_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,
                            model <span class="op">=</span> <span class="st">"Mt"</span>,
                            hidden_condition <span class="op">=</span> <span class="st">"hidden == 1"</span>,
                            label <span class="op">=</span> <span class="st">"all_recap"</span><span class="op">)</span>,
               recap2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">get_study_est_recapture</span>,
                             capture_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rds"</span>, <span class="st">"pps"</span><span class="op">)</span>,
                             model <span class="op">=</span> <span class="st">"Mt"</span>,
                             hidden_condition <span class="op">=</span> <span class="st">"hidden == 1"</span>,
                             label <span class="op">=</span> <span class="st">"samp_recap"</span><span class="op">)</span><span class="op">)</span>
      <span class="op">)</span>
  <span class="op">)</span></code></pre></div>
</div>
<div id="step-2-declare-study-population" class="section level2">
<h2 class="hasAnchor">
<a href="#step-2-declare-study-population" class="anchor"></a>Step 2. Declare study population</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">study_population</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/call.html">as.call</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">declare_population</span><span class="op">)</span>, <span class="va">study_1</span><span class="op">$</span><span class="va">pop</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">19872312</span><span class="op">)</span>
<span class="op">(</span> <span class="va">example_pop</span> <span class="op">&lt;-</span> <span class="fu">study_population</span><span class="op">(</span><span class="op">)</span> <span class="op">)</span>
<span class="co">#&gt; # A tibble: 2,000 x 51</span>
<span class="co">#&gt;     name type  known hidden links    service_use loc_1 loc_2 loc_3 loc_4 known_2</span>
<span class="co">#&gt;    &lt;int&gt; &lt;chr&gt; &lt;int&gt;  &lt;int&gt; &lt;chr&gt;          &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;</span>
<span class="co">#&gt;  1     1 00        0      0 166;107…           0     0     0     0     0       0</span>
<span class="co">#&gt;  2     2 00        0      0 84;199;…           0     0     0     0     0       0</span>
<span class="co">#&gt;  3     3 00        0      0 143;167…           1     1     0     0     0       0</span>
<span class="co">#&gt;  4     4 00        0      0 272;300…           0     1     0     0     1       0</span>
<span class="co">#&gt;  5     5 00        0      0 29;536;…           0     0     1     0     0       0</span>
<span class="co">#&gt;  6     6 00        0      0 745;103…           1     0     1     0     0       0</span>
<span class="co">#&gt;  7     7 00        0      0 66;933;…           0     0     0     0     0       0</span>
<span class="co">#&gt;  8     8 00        0      0 526;107…           1     0     0     0     0       0</span>
<span class="co">#&gt;  9     9 00        0      0 111;1078           0     0     0     0     0       0</span>
<span class="co">#&gt; 10    10 00        0      0 377;1992           0     0     0     0     1       0</span>
<span class="co">#&gt; # … with 1,990 more rows, and 40 more variables: known_3 &lt;int&gt;,</span>
<span class="co">#&gt; #   n_visible_out &lt;dbl&gt;, known_visible_out &lt;dbl&gt;, hidden_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   type_00_visible_out &lt;dbl&gt;, type_01_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   type_10_visible_out &lt;dbl&gt;, type_11_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   service_use_visible_out &lt;dbl&gt;, loc_1_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   loc_2_visible_out &lt;dbl&gt;, loc_3_visible_out &lt;dbl&gt;, loc_4_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   known_2_visible_out &lt;dbl&gt;, known_3_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   known_visible_in &lt;dbl&gt;, hidden_visible_in &lt;dbl&gt;, type_00_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   type_01_visible_in &lt;dbl&gt;, type_10_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   type_11_visible_in &lt;dbl&gt;, service_use_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   loc_1_visible_in &lt;dbl&gt;, loc_2_visible_in &lt;dbl&gt;, loc_3_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   loc_4_visible_in &lt;dbl&gt;, known_2_visible_in &lt;dbl&gt;, known_3_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   p_visible_known &lt;dbl&gt;, p_visible_hidden &lt;dbl&gt;, total &lt;int&gt;,</span>
<span class="co">#&gt; #   total_known &lt;int&gt;, total_hidden &lt;int&gt;, total_service_use &lt;int&gt;,</span>
<span class="co">#&gt; #   total_loc_1 &lt;int&gt;, total_loc_2 &lt;int&gt;, total_loc_3 &lt;int&gt;, total_loc_4 &lt;int&gt;,</span>
<span class="co">#&gt; #   total_known_2 &lt;int&gt;, total_known_3 &lt;int&gt;</span></code></pre></div>
<div id="show-the-network" class="section level3">
<h3 class="hasAnchor">
<a href="#show-the-network" class="anchor"></a>Show the network</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">&lt;-</span>
  <span class="va">example_pop</span> <span class="op">%$%</span> <span class="op">{</span>
    <span class="fu">hiddenmeta</span><span class="fu">:::</span><span class="fu">retrieve_graph</span><span class="op">(</span><span class="va">links</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/set_vertex_attr.html">set_vertex_attr</a></span><span class="op">(</span><span class="st">"name"</span>, value <span class="op">=</span> <span class="va">name</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/set_vertex_attr.html">set_vertex_attr</a></span><span class="op">(</span><span class="st">"type"</span>, value <span class="op">=</span> <span class="va">type</span><span class="op">)</span>
  <span class="op">}</span>

<span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span>
  <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html">mapvalues</a></span><span class="op">(</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">type</span>,
                  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">type</span><span class="op">)</span>,
                  to <span class="op">=</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html">palette.colors</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">type</span><span class="op">)</span><span class="op">)</span>, 
                                                 palette <span class="op">=</span> <span class="st">"Set 3"</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">g</span>,
     layout <span class="op">=</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_on_grid.html">layout_on_grid</a></span><span class="op">(</span><span class="va">g</span>, dim <span class="op">=</span> <span class="fl">2</span>, width <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,
     vertex.size <span class="op">=</span> <span class="fl">3</span>, vertex.dist <span class="op">=</span> <span class="fl">2</span>, vertex.label <span class="op">=</span> <span class="cn">NA</span>, edge.width <span class="op">=</span> <span class="fl">1</span>,
     edge.arrow.size <span class="op">=</span> <span class="fl">.2</span>, edge.curved <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, y <span class="op">=</span> <span class="op">-</span><span class="fl">1.2</span>,
       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"known only"</span>, <span class="st">"hidden only"</span>, <span class="st">"both"</span><span class="op">)</span>,
       pt.bg <span class="op">=</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html">palette.colors</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">type</span><span class="op">)</span><span class="op">)</span>, palette <span class="op">=</span> <span class="st">"Set 3"</span><span class="op">)</span>,
       pch <span class="op">=</span> <span class="fl">21</span>, col <span class="op">=</span> <span class="st">"#777777"</span>, pt.cex <span class="op">=</span> <span class="fl">2</span>, cex <span class="op">=</span> <span class="fl">1.5</span>, bty <span class="op">=</span> <span class="st">"o"</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="README-plot_pop_network-1.png"><!-- --></p>
</div>
</div>
<div id="step-3-declare-all-relevant-study-sampling-procedures" class="section level2">
<h2 class="hasAnchor">
<a href="#step-3-declare-all-relevant-study-sampling-procedures" class="anchor"></a>Step 3. Declare all relevant study sampling procedures</h2>
<p>The sampling procedures are additive in a sense that each procedure appends several columns relevant to the sampling procedure and particular draw based on population simulation, but does not change the study population data frame (unless you specify <code>drop_nonsampled = TRUE</code>).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">study_sample_rds</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/call.html">as.call</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">declare_sampling</span><span class="op">)</span>, <span class="va">study_1</span><span class="op">$</span><span class="va">sample</span><span class="op">$</span><span class="va">rds</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">19872312</span><span class="op">)</span>
<span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/draw_functions.html">draw_data</a></span><span class="op">(</span><span class="va">study_population</span> <span class="op">+</span> <span class="va">study_sample_rds</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2,000 x 60</span>
<span class="co">#&gt;     name type  known hidden links    service_use loc_1 loc_2 loc_3 loc_4 known_2</span>
<span class="co">#&gt;    &lt;int&gt; &lt;chr&gt; &lt;int&gt;  &lt;int&gt; &lt;chr&gt;          &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;</span>
<span class="co">#&gt;  1     1 00        0      0 166;107…           0     0     0     0     0       0</span>
<span class="co">#&gt;  2     2 00        0      0 84;199;…           0     0     0     0     0       0</span>
<span class="co">#&gt;  3     3 00        0      0 143;167…           1     1     0     0     0       0</span>
<span class="co">#&gt;  4     4 00        0      0 272;300…           0     1     0     0     1       0</span>
<span class="co">#&gt;  5     5 00        0      0 29;536;…           0     0     1     0     0       0</span>
<span class="co">#&gt;  6     6 00        0      0 745;103…           1     0     1     0     0       0</span>
<span class="co">#&gt;  7     7 00        0      0 66;933;…           0     0     0     0     0       0</span>
<span class="co">#&gt;  8     8 00        0      0 526;107…           1     0     0     0     0       0</span>
<span class="co">#&gt;  9     9 00        0      0 111;1078           0     0     0     0     0       0</span>
<span class="co">#&gt; 10    10 00        0      0 377;1992           0     0     0     0     1       0</span>
<span class="co">#&gt; # … with 1,990 more rows, and 49 more variables: known_3 &lt;int&gt;,</span>
<span class="co">#&gt; #   n_visible_out &lt;dbl&gt;, known_visible_out &lt;dbl&gt;, hidden_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   type_00_visible_out &lt;dbl&gt;, type_01_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   type_10_visible_out &lt;dbl&gt;, type_11_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   service_use_visible_out &lt;dbl&gt;, loc_1_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   loc_2_visible_out &lt;dbl&gt;, loc_3_visible_out &lt;dbl&gt;, loc_4_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   known_2_visible_out &lt;dbl&gt;, known_3_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   known_visible_in &lt;dbl&gt;, hidden_visible_in &lt;dbl&gt;, type_00_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   type_01_visible_in &lt;dbl&gt;, type_10_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   type_11_visible_in &lt;dbl&gt;, service_use_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   loc_1_visible_in &lt;dbl&gt;, loc_2_visible_in &lt;dbl&gt;, loc_3_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   loc_4_visible_in &lt;dbl&gt;, known_2_visible_in &lt;dbl&gt;, known_3_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   p_visible_known &lt;dbl&gt;, p_visible_hidden &lt;dbl&gt;, total &lt;int&gt;,</span>
<span class="co">#&gt; #   total_known &lt;int&gt;, total_hidden &lt;int&gt;, total_service_use &lt;int&gt;,</span>
<span class="co">#&gt; #   total_loc_1 &lt;int&gt;, total_loc_2 &lt;int&gt;, total_loc_3 &lt;int&gt;, total_loc_4 &lt;int&gt;,</span>
<span class="co">#&gt; #   total_known_2 &lt;int&gt;, total_known_3 &lt;int&gt;, rds &lt;int&gt;, rds_from &lt;dbl&gt;,</span>
<span class="co">#&gt; #   rds_t &lt;dbl&gt;, rds_wave &lt;dbl&gt;, rds_hidden &lt;int&gt;, rds_own_coupon &lt;chr&gt;,</span>
<span class="co">#&gt; #   rds_coupon_1 &lt;chr&gt;, rds_coupon_2 &lt;chr&gt;, rds_coupon_3 &lt;chr&gt;</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">study_sample_pps</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/call.html">as.call</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">declare_sampling</span><span class="op">)</span>, <span class="va">study_1</span><span class="op">$</span><span class="va">sample</span><span class="op">$</span><span class="va">pps</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">19872312</span><span class="op">)</span>
<span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/draw_functions.html">draw_data</a></span><span class="op">(</span><span class="va">study_population</span> <span class="op">+</span> <span class="va">study_sample_rds</span> <span class="op">+</span> <span class="va">study_sample_pps</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2,000 x 68</span>
<span class="co">#&gt;     name type  known hidden links    service_use loc_1 loc_2 loc_3 loc_4 known_2</span>
<span class="co">#&gt;    &lt;int&gt; &lt;chr&gt; &lt;int&gt;  &lt;int&gt; &lt;chr&gt;          &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;</span>
<span class="co">#&gt;  1     1 00        0      0 166;107…           0     0     0     0     0       0</span>
<span class="co">#&gt;  2     2 00        0      0 84;199;…           0     0     0     0     0       0</span>
<span class="co">#&gt;  3     3 00        0      0 143;167…           1     1     0     0     0       0</span>
<span class="co">#&gt;  4     4 00        0      0 272;300…           0     1     0     0     1       0</span>
<span class="co">#&gt;  5     5 00        0      0 29;536;…           0     0     1     0     0       0</span>
<span class="co">#&gt;  6     6 00        0      0 745;103…           1     0     1     0     0       0</span>
<span class="co">#&gt;  7     7 00        0      0 66;933;…           0     0     0     0     0       0</span>
<span class="co">#&gt;  8     8 00        0      0 526;107…           1     0     0     0     0       0</span>
<span class="co">#&gt;  9     9 00        0      0 111;1078           0     0     0     0     0       0</span>
<span class="co">#&gt; 10    10 00        0      0 377;1992           0     0     0     0     1       0</span>
<span class="co">#&gt; # … with 1,990 more rows, and 57 more variables: known_3 &lt;int&gt;,</span>
<span class="co">#&gt; #   n_visible_out &lt;dbl&gt;, known_visible_out &lt;dbl&gt;, hidden_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   type_00_visible_out &lt;dbl&gt;, type_01_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   type_10_visible_out &lt;dbl&gt;, type_11_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   service_use_visible_out &lt;dbl&gt;, loc_1_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   loc_2_visible_out &lt;dbl&gt;, loc_3_visible_out &lt;dbl&gt;, loc_4_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   known_2_visible_out &lt;dbl&gt;, known_3_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   known_visible_in &lt;dbl&gt;, hidden_visible_in &lt;dbl&gt;, type_00_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   type_01_visible_in &lt;dbl&gt;, type_10_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   type_11_visible_in &lt;dbl&gt;, service_use_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   loc_1_visible_in &lt;dbl&gt;, loc_2_visible_in &lt;dbl&gt;, loc_3_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   loc_4_visible_in &lt;dbl&gt;, known_2_visible_in &lt;dbl&gt;, known_3_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   p_visible_known &lt;dbl&gt;, p_visible_hidden &lt;dbl&gt;, total &lt;int&gt;,</span>
<span class="co">#&gt; #   total_known &lt;int&gt;, total_hidden &lt;int&gt;, total_service_use &lt;int&gt;,</span>
<span class="co">#&gt; #   total_loc_1 &lt;int&gt;, total_loc_2 &lt;int&gt;, total_loc_3 &lt;int&gt;, total_loc_4 &lt;int&gt;,</span>
<span class="co">#&gt; #   total_known_2 &lt;int&gt;, total_known_3 &lt;int&gt;, rds &lt;int&gt;, rds_from &lt;dbl&gt;,</span>
<span class="co">#&gt; #   rds_t &lt;dbl&gt;, rds_wave &lt;dbl&gt;, rds_hidden &lt;int&gt;, rds_own_coupon &lt;chr&gt;,</span>
<span class="co">#&gt; #   rds_coupon_1 &lt;chr&gt;, rds_coupon_2 &lt;chr&gt;, rds_coupon_3 &lt;chr&gt;,</span>
<span class="co">#&gt; #   pps_frame &lt;dbl&gt;, pps_strata &lt;dbl&gt;, pps_strata_prop &lt;dbl&gt;,</span>
<span class="co">#&gt; #   pps_cluster &lt;int&gt;, pps_cluster_prop &lt;dbl&gt;, pps &lt;dbl&gt;,</span>
<span class="co">#&gt; #   pps_sampled_cluster &lt;dbl&gt;, pps_weight &lt;dbl&gt;</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">study_sample_tls</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/call.html">as.call</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">declare_sampling</span><span class="op">)</span>, <span class="va">study_1</span><span class="op">$</span><span class="va">sample</span><span class="op">$</span><span class="va">tls</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">19872312</span><span class="op">)</span>
<span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/draw_functions.html">draw_data</a></span><span class="op">(</span><span class="va">study_population</span> <span class="op">+</span> 
            <span class="va">study_sample_rds</span> <span class="op">+</span> <span class="va">study_sample_pps</span> <span class="op">+</span> <span class="va">study_sample_tls</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2,000 x 73</span>
<span class="co">#&gt;     name type  known hidden links    service_use loc_1 loc_2 loc_3 loc_4 known_2</span>
<span class="co">#&gt;    &lt;int&gt; &lt;chr&gt; &lt;int&gt;  &lt;int&gt; &lt;chr&gt;          &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;</span>
<span class="co">#&gt;  1     1 00        0      0 166;107…           0     0     0     0     0       0</span>
<span class="co">#&gt;  2     2 00        0      0 84;199;…           0     0     0     0     0       0</span>
<span class="co">#&gt;  3     3 00        0      0 143;167…           1     1     0     0     0       0</span>
<span class="co">#&gt;  4     4 00        0      0 272;300…           0     1     0     0     1       0</span>
<span class="co">#&gt;  5     5 00        0      0 29;536;…           0     0     1     0     0       0</span>
<span class="co">#&gt;  6     6 00        0      0 745;103…           1     0     1     0     0       0</span>
<span class="co">#&gt;  7     7 00        0      0 66;933;…           0     0     0     0     0       0</span>
<span class="co">#&gt;  8     8 00        0      0 526;107…           1     0     0     0     0       0</span>
<span class="co">#&gt;  9     9 00        0      0 111;1078           0     0     0     0     0       0</span>
<span class="co">#&gt; 10    10 00        0      0 377;1992           0     0     0     0     1       0</span>
<span class="co">#&gt; # … with 1,990 more rows, and 62 more variables: known_3 &lt;int&gt;,</span>
<span class="co">#&gt; #   n_visible_out &lt;dbl&gt;, known_visible_out &lt;dbl&gt;, hidden_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   type_00_visible_out &lt;dbl&gt;, type_01_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   type_10_visible_out &lt;dbl&gt;, type_11_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   service_use_visible_out &lt;dbl&gt;, loc_1_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   loc_2_visible_out &lt;dbl&gt;, loc_3_visible_out &lt;dbl&gt;, loc_4_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   known_2_visible_out &lt;dbl&gt;, known_3_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   known_visible_in &lt;dbl&gt;, hidden_visible_in &lt;dbl&gt;, type_00_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   type_01_visible_in &lt;dbl&gt;, type_10_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   type_11_visible_in &lt;dbl&gt;, service_use_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   loc_1_visible_in &lt;dbl&gt;, loc_2_visible_in &lt;dbl&gt;, loc_3_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   loc_4_visible_in &lt;dbl&gt;, known_2_visible_in &lt;dbl&gt;, known_3_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   p_visible_known &lt;dbl&gt;, p_visible_hidden &lt;dbl&gt;, total &lt;int&gt;,</span>
<span class="co">#&gt; #   total_known &lt;int&gt;, total_hidden &lt;int&gt;, total_service_use &lt;int&gt;,</span>
<span class="co">#&gt; #   total_loc_1 &lt;int&gt;, total_loc_2 &lt;int&gt;, total_loc_3 &lt;int&gt;, total_loc_4 &lt;int&gt;,</span>
<span class="co">#&gt; #   total_known_2 &lt;int&gt;, total_known_3 &lt;int&gt;, rds &lt;int&gt;, rds_from &lt;dbl&gt;,</span>
<span class="co">#&gt; #   rds_t &lt;dbl&gt;, rds_wave &lt;dbl&gt;, rds_hidden &lt;int&gt;, rds_own_coupon &lt;chr&gt;,</span>
<span class="co">#&gt; #   rds_coupon_1 &lt;chr&gt;, rds_coupon_2 &lt;chr&gt;, rds_coupon_3 &lt;chr&gt;,</span>
<span class="co">#&gt; #   pps_frame &lt;dbl&gt;, pps_strata &lt;dbl&gt;, pps_strata_prop &lt;dbl&gt;,</span>
<span class="co">#&gt; #   pps_cluster &lt;int&gt;, pps_cluster_prop &lt;dbl&gt;, pps &lt;dbl&gt;,</span>
<span class="co">#&gt; #   pps_sampled_cluster &lt;dbl&gt;, pps_weight &lt;dbl&gt;, tls &lt;dbl&gt;,</span>
<span class="co">#&gt; #   tls_loc_present &lt;chr&gt;, tls_locs_sampled &lt;chr&gt;, tls_cluster &lt;chr&gt;,</span>
<span class="co">#&gt; #   tls_weight &lt;dbl&gt;</span></code></pre></div>
</div>
<div id="step-4-declare-study-level-estimands" class="section level2">
<h2 class="hasAnchor">
<a href="#step-4-declare-study-level-estimands" class="anchor"></a>Step 4. Declare study level estimands</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">study_estimands</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/call.html">as.call</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">declare_inquiry</span><span class="op">)</span>, <span class="va">study_1</span><span class="op">$</span><span class="va">inquiries</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">19872312</span><span class="op">)</span>
<span class="fu">draw_inquiry</span><span class="op">(</span><span class="va">study_population</span> <span class="op">+</span> 
                <span class="co"># study_sample_rds + study_sample_pps + study_sample_tls + </span>
                <span class="va">study_estimands</span><span class="op">)</span>
<span class="co">#&gt;           inquiry_label estimand</span>
<span class="co">#&gt; 1           hidden_size 190.0000</span>
<span class="co">#&gt; 2           hidden_prev   0.0950</span>
<span class="co">#&gt; 3        degree_average   4.9310</span>
<span class="co">#&gt; 4 degree_hidden_average   0.7155</span></code></pre></div>
</div>
<div id="step-5-declare-estimators-used-in-the-study" class="section level2">
<h2 class="hasAnchor">
<a href="#step-5-declare-estimators-used-in-the-study" class="anchor"></a>Step 5. Declare estimators used in the study</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">est_sspse</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/call.html">as.call</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">declare_estimator</span><span class="op">)</span>, <span class="va">study_1</span><span class="op">$</span><span class="va">estimators</span><span class="op">$</span><span class="va">rds</span><span class="op">$</span><span class="va">sspse</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">est_chords</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/call.html">as.call</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">declare_estimator</span><span class="op">)</span>, <span class="va">study_1</span><span class="op">$</span><span class="va">estimators</span><span class="op">$</span><span class="va">rds</span><span class="op">$</span><span class="va">chords</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">est_multi</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/call.html">as.call</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">declare_estimator</span><span class="op">)</span>, <span class="va">study_1</span><span class="op">$</span><span class="va">estimators</span><span class="op">$</span><span class="va">rds</span><span class="op">$</span><span class="va">multiplier</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">est_ht_pps</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/call.html">as.call</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">declare_estimator</span><span class="op">)</span>, <span class="va">study_1</span><span class="op">$</span><span class="va">estimators</span><span class="op">$</span><span class="va">pps</span><span class="op">$</span><span class="va">ht</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">est_nsum_pps</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/call.html">as.call</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">declare_estimator</span><span class="op">)</span>, <span class="va">study_1</span><span class="op">$</span><span class="va">estimators</span><span class="op">$</span><span class="va">pps</span><span class="op">$</span><span class="va">nsum</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">est_ht_tls</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/call.html">as.call</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">declare_estimator</span><span class="op">)</span>, <span class="va">study_1</span><span class="op">$</span><span class="va">estimators</span><span class="op">$</span><span class="va">tls</span><span class="op">$</span><span class="va">ht</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">est_nsum_tls</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/call.html">as.call</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">declare_estimator</span><span class="op">)</span>, <span class="va">study_1</span><span class="op">$</span><span class="va">estimators</span><span class="op">$</span><span class="va">tls</span><span class="op">$</span><span class="va">nsum</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">est_recap</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/call.html">as.call</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">declare_estimator</span><span class="op">)</span>, <span class="va">study_1</span><span class="op">$</span><span class="va">estimators</span><span class="op">$</span><span class="va">all</span><span class="op">$</span><span class="va">recap</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">est_recap2</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/call.html">as.call</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">declare_estimator</span><span class="op">)</span>, <span class="va">study_1</span><span class="op">$</span><span class="va">estimators</span><span class="op">$</span><span class="va">all</span><span class="op">$</span><span class="va">recap2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">19872312</span><span class="op">)</span>
<span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/draw_functions.html">draw_estimates</a></span><span class="op">(</span><span class="va">study_population</span> <span class="op">+</span>
                 <span class="va">study_sample_rds</span> <span class="op">+</span> <span class="va">study_sample_pps</span> <span class="op">+</span> <span class="va">study_sample_tls</span> <span class="op">+</span>
                 <span class="va">study_estimands</span> <span class="op">+</span>
                 <span class="va">est_sspse</span> <span class="op">+</span> <span class="va">est_chords</span> <span class="op">+</span> <span class="va">est_multi</span> <span class="op">+</span>
                 <span class="va">est_ht_tls</span> <span class="op">+</span> <span class="va">est_ht_pps</span> <span class="op">+</span>
                 <span class="va">est_nsum_tls</span> <span class="op">+</span> <span class="va">est_nsum_pps</span> <span class="op">+</span>
                 <span class="va">est_recap</span> <span class="op">+</span> <span class="va">est_recap2</span><span class="op">)</span>
<span class="co">#&gt;             estimator_label    estimate           se         inquiry_label</span>
<span class="co">#&gt; 1     hidden_size_rds_sspse 141.0000000 39.602863401           hidden_size</span>
<span class="co">#&gt; 2    hidden_size_rds_chords 158.0000000 59.380276799           hidden_size</span>
<span class="co">#&gt; 3  degree_hidden_rds_chords   4.9240506  0.807132243 degree_hidden_average</span>
<span class="co">#&gt; 4     hidden_size_rds_multi 180.5555556 25.649056775           hidden_size</span>
<span class="co">#&gt; 5        hidden_size_tls_ht  80.0000000 17.059572100           hidden_size</span>
<span class="co">#&gt; 6        hidden_prev_tls_ht   0.0400000  0.008529786           hidden_prev</span>
<span class="co">#&gt; 7        hidden_size_pps_ht 155.0000000 27.265348311           hidden_size</span>
<span class="co">#&gt; 8        hidden_prev_pps_ht   0.0775000  0.013632674           hidden_prev</span>
<span class="co">#&gt; 9      hidden_size_tls_nsum 433.3825108 55.589475936           hidden_size</span>
<span class="co">#&gt; 10          degree_tls_nsum   0.4857944  0.132946002        degree_average</span>
<span class="co">#&gt; 11     hidden_size_pps_nsum 170.1373183 28.171363409           hidden_size</span>
<span class="co">#&gt; 12          degree_pps_nsum  58.7286145 10.473314912        degree_average</span>
<span class="co">#&gt; 13    hidden_size_all_recap 198.1868365 11.900941786           hidden_size</span>
<span class="co">#&gt; 14   hidden_size_samp_recap 201.0000000 31.780497164           hidden_size</span></code></pre></div>
</div>
<div id="step-6-declare-full-study" class="section level2">
<h2 class="hasAnchor">
<a href="#step-6-declare-full-study" class="anchor"></a>Step 6. Declare full study</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">study1</span> <span class="op">&lt;-</span> 
  <span class="va">study_population</span> <span class="op">+</span>
  <span class="va">study_sample_rds</span> <span class="op">+</span> <span class="va">study_sample_pps</span> <span class="op">+</span> <span class="va">study_sample_tls</span> <span class="op">+</span>
  <span class="va">study_estimands</span> <span class="op">+</span>
  <span class="va">est_sspse</span> <span class="op">+</span> <span class="va">est_chords</span> <span class="op">+</span> <span class="va">est_multi</span> <span class="op">+</span>
  <span class="va">est_ht_tls</span> <span class="op">+</span> <span class="va">est_ht_pps</span> <span class="op">+</span>
  <span class="va">est_nsum_tls</span> <span class="op">+</span> <span class="va">est_nsum_pps</span> <span class="op">+</span>
  <span class="va">est_recap</span> <span class="op">+</span> <span class="va">est_recap2</span>

<span class="co"># can draw one of the samples</span>
<span class="va">study1</span><span class="op">$</span><span class="fu">study_sample_rds</span><span class="op">(</span><span class="va">study1</span><span class="op">$</span><span class="fu">study_population</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2,000 x 60</span>
<span class="co">#&gt;     name type  known hidden links    service_use loc_1 loc_2 loc_3 loc_4 known_2</span>
<span class="co">#&gt;    &lt;int&gt; &lt;chr&gt; &lt;int&gt;  &lt;int&gt; &lt;chr&gt;          &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;   &lt;int&gt;</span>
<span class="co">#&gt;  1     1 00        0      0 276;765…           0     0     0     0     0       1</span>
<span class="co">#&gt;  2     2 00        0      0 496;891…           1     0     0     0     0       0</span>
<span class="co">#&gt;  3     3 00        0      0 691;1458           0     0     0     0     0       0</span>
<span class="co">#&gt;  4     4 00        0      0 69;1068…           0     0     0     0     0       0</span>
<span class="co">#&gt;  5     5 00        0      0 713;914…           1     0     0     0     0       0</span>
<span class="co">#&gt;  6     6 00        0      0 313                0     0     0     0     0       1</span>
<span class="co">#&gt;  7     7 00        0      0 253;379…           0     0     0     0     0       0</span>
<span class="co">#&gt;  8     8 00        0      0 795;1021           0     0     0     0     0       0</span>
<span class="co">#&gt;  9     9 00        0      0 286;417…           0     0     0     1     0       0</span>
<span class="co">#&gt; 10    10 00        0      0 42;232;…           0     0     0     0     0       0</span>
<span class="co">#&gt; # … with 1,990 more rows, and 49 more variables: known_3 &lt;int&gt;,</span>
<span class="co">#&gt; #   n_visible_out &lt;dbl&gt;, known_visible_out &lt;dbl&gt;, hidden_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   type_00_visible_out &lt;dbl&gt;, type_01_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   type_10_visible_out &lt;dbl&gt;, type_11_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   service_use_visible_out &lt;dbl&gt;, loc_1_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   loc_2_visible_out &lt;dbl&gt;, loc_3_visible_out &lt;dbl&gt;, loc_4_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   known_2_visible_out &lt;dbl&gt;, known_3_visible_out &lt;dbl&gt;,</span>
<span class="co">#&gt; #   known_visible_in &lt;dbl&gt;, hidden_visible_in &lt;dbl&gt;, type_00_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   type_01_visible_in &lt;dbl&gt;, type_10_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   type_11_visible_in &lt;dbl&gt;, service_use_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   loc_1_visible_in &lt;dbl&gt;, loc_2_visible_in &lt;dbl&gt;, loc_3_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   loc_4_visible_in &lt;dbl&gt;, known_2_visible_in &lt;dbl&gt;, known_3_visible_in &lt;dbl&gt;,</span>
<span class="co">#&gt; #   p_visible_known &lt;dbl&gt;, p_visible_hidden &lt;dbl&gt;, total &lt;int&gt;,</span>
<span class="co">#&gt; #   total_known &lt;int&gt;, total_hidden &lt;int&gt;, total_service_use &lt;int&gt;,</span>
<span class="co">#&gt; #   total_loc_1 &lt;int&gt;, total_loc_2 &lt;int&gt;, total_loc_3 &lt;int&gt;, total_loc_4 &lt;int&gt;,</span>
<span class="co">#&gt; #   total_known_2 &lt;int&gt;, total_known_3 &lt;int&gt;, rds &lt;int&gt;, rds_from &lt;dbl&gt;,</span>
<span class="co">#&gt; #   rds_t &lt;dbl&gt;, rds_wave &lt;dbl&gt;, rds_hidden &lt;int&gt;, rds_own_coupon &lt;chr&gt;,</span>
<span class="co">#&gt; #   rds_coupon_1 &lt;chr&gt;, rds_coupon_2 &lt;chr&gt;, rds_coupon_3 &lt;chr&gt;</span>

<span class="co"># can draw full data</span>
<span class="va">study1_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/draw_functions.html">draw_data</a></span><span class="op">(</span><span class="va">study1</span><span class="op">)</span>

<span class="co"># can draw estimands</span>
<span class="va">study1</span><span class="op">$</span><span class="fu">inquiry</span><span class="op">(</span><span class="va">study1_data</span><span class="op">)</span>
<span class="co">#&gt;            inquiry_label estimand</span>
<span class="co">#&gt; 4            hidden_size  208.000</span>
<span class="co">#&gt; 8            hidden_prev    0.104</span>
<span class="co">#&gt; 9         degree_average    4.960</span>
<span class="co">#&gt; 10 degree_hidden_average    0.835</span>

<span class="co"># can draw any of the estimators</span>
<span class="va">study1</span><span class="op">$</span><span class="fu">rds_sspse</span><span class="op">(</span><span class="va">study1_data</span><span class="op">)</span>
<span class="co">#&gt;         estimator_label estimate       se inquiry_label</span>
<span class="co">#&gt; 1 hidden_size_rds_sspse      168 84.34912   hidden_size</span>
<span class="va">study1</span><span class="op">$</span><span class="fu">pps_ht</span><span class="op">(</span><span class="va">study1_data</span><span class="op">)</span>
<span class="co">#&gt;      estimator_label estimate          se inquiry_label</span>
<span class="co">#&gt; 1 hidden_size_pps_ht  170.000 26.50391276   hidden_size</span>
<span class="co">#&gt; 2 hidden_prev_pps_ht    0.085  0.01325196   hidden_prev</span>
<span class="va">study1</span><span class="op">$</span><span class="fu">samp_recap</span><span class="op">(</span><span class="va">study1_data</span><span class="op">)</span>
<span class="co">#&gt;          estimator_label estimate       se inquiry_label</span>
<span class="co">#&gt; 1 hidden_size_samp_recap 167.3333 20.20101   hidden_size</span></code></pre></div>
</div>
<div id="step-7-diagnose-study-design" class="section level2">
<h2 class="hasAnchor">
<a href="#step-7-diagnose-study-design" class="anchor"></a>Step 7. Diagnose study design</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">study_diagnosands</span> <span class="op">&lt;-</span>
 <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_diagnosands.html">declare_diagnosands</a></span><span class="op">(</span>
    mean_estimand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">estimand</span><span class="op">)</span>,
    mean_estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span>,
    sd_estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span>,
    mean_se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>,
    bias <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">estimate</span> <span class="op">-</span> <span class="va">estimand</span><span class="op">)</span>,
    rmse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">estimate</span> <span class="op">-</span> <span class="va">estimand</span><span class="op">)</span> <span class="op">^</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">study1_simulations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/simulate_design.html">simulate_design</a></span><span class="op">(</span><span class="va">study1</span>, sims <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>

<span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/diagnose_design.html">diagnose_design</a></span><span class="op">(</span><span class="va">study1_simulations</span>, 
                diagnosands <span class="op">=</span> <span class="va">study_diagnosands</span>, sims <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Research design diagnosis based on 10 simulations. Diagnosand estimates with bootstrapped standard errors in parentheses (100 replicates).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Design Label         Inquiry Label          Estimator Label N Sims</span>
<span class="co">#&gt;        study1        degree_average          degree_pps_nsum     10</span>
<span class="co">#&gt;                                                                    </span>
<span class="co">#&gt;        study1        degree_average          degree_tls_nsum     10</span>
<span class="co">#&gt;                                                                    </span>
<span class="co">#&gt;        study1 degree_hidden_average degree_hidden_rds_chords     10</span>
<span class="co">#&gt;                                                                    </span>
<span class="co">#&gt;        study1           hidden_prev       hidden_prev_pps_ht     10</span>
<span class="co">#&gt;                                                                    </span>
<span class="co">#&gt;        study1           hidden_prev       hidden_prev_tls_ht     10</span>
<span class="co">#&gt;                                                                    </span>
<span class="co">#&gt;        study1           hidden_size    hidden_size_all_recap     10</span>
<span class="co">#&gt;                                                                    </span>
<span class="co">#&gt;        study1           hidden_size       hidden_size_pps_ht     10</span>
<span class="co">#&gt;                                                                    </span>
<span class="co">#&gt;        study1           hidden_size     hidden_size_pps_nsum     10</span>
<span class="co">#&gt;                                                                    </span>
<span class="co">#&gt;        study1           hidden_size   hidden_size_rds_chords     10</span>
<span class="co">#&gt;                                                                    </span>
<span class="co">#&gt;        study1           hidden_size    hidden_size_rds_multi     10</span>
<span class="co">#&gt;                                                                    </span>
<span class="co">#&gt;        study1           hidden_size    hidden_size_rds_sspse     10</span>
<span class="co">#&gt;                                                                    </span>
<span class="co">#&gt;        study1           hidden_size   hidden_size_samp_recap     10</span>
<span class="co">#&gt;                                                                    </span>
<span class="co">#&gt;        study1           hidden_size       hidden_size_tls_ht     10</span>
<span class="co">#&gt;                                                                    </span>
<span class="co">#&gt;        study1           hidden_size     hidden_size_tls_nsum     10</span>
<span class="co">#&gt;                                                                    </span>
<span class="co">#&gt;  Mean Estimand Mean Estimate SD Estimate Mean Se    Bias    RMSE</span>
<span class="co">#&gt;           4.93         50.87        5.42    7.88   45.93   46.23</span>
<span class="co">#&gt;         (0.03)        (1.76)      (0.84)  (0.35)  (1.77)  (1.78)</span>
<span class="co">#&gt;           4.93          0.48        0.13    0.15   -4.45    4.46</span>
<span class="co">#&gt;         (0.03)        (0.05)      (0.03)  (0.06)  (0.06)  (0.06)</span>
<span class="co">#&gt;           0.76          5.66        0.79    0.76    4.89    4.95</span>
<span class="co">#&gt;         (0.02)        (0.24)      (0.16)  (0.02)  (0.22)  (0.22)</span>
<span class="co">#&gt;           0.10          0.09        0.01    0.01   -0.01    0.01</span>
<span class="co">#&gt;         (0.00)        (0.00)      (0.00)  (0.00)  (0.00)  (0.00)</span>
<span class="co">#&gt;           0.10          0.06        0.01    0.01   -0.03    0.03</span>
<span class="co">#&gt;         (0.00)        (0.00)      (0.00)  (0.00)  (0.00)  (0.00)</span>
<span class="co">#&gt;         196.00        199.12        9.39   11.57    3.12    6.20</span>
<span class="co">#&gt;         (2.98)        (2.98)      (2.00)  (0.45)  (1.57)  (0.96)</span>
<span class="co">#&gt;         196.00        179.00       15.24   29.10  -17.00   22.04</span>
<span class="co">#&gt;         (2.98)        (4.70)      (3.35)  (0.34)  (4.37)  (4.02)</span>
<span class="co">#&gt;         196.00        197.27       20.73   29.06    1.27   17.67</span>
<span class="co">#&gt;         (2.98)        (6.68)      (3.92)  (1.08)  (5.93)  (2.77)</span>
<span class="co">#&gt;         196.00        140.50       67.29   59.34  -55.50   83.71</span>
<span class="co">#&gt;         (2.98)       (18.28)      (9.42)  (2.84) (17.99) (15.92)</span>
<span class="co">#&gt;         196.00        208.84       47.49   38.49   12.84   43.76</span>
<span class="co">#&gt;         (2.98)       (14.07)     (13.95)  (6.28) (12.76) (15.58)</span>
<span class="co">#&gt;         196.00        183.35       13.74   85.60  -12.65   18.68</span>
<span class="co">#&gt;         (2.98)        (3.63)      (2.26)  (7.29)  (4.12)  (4.23)</span>
<span class="co">#&gt;         196.00        188.53       42.79   26.15   -7.47   40.51</span>
<span class="co">#&gt;         (2.98)       (13.15)     (17.32)  (4.11) (12.58) (13.05)</span>
<span class="co">#&gt;         196.00        129.00       22.46   21.59  -67.00   68.95</span>
<span class="co">#&gt;         (2.98)        (7.62)      (5.09)  (0.61)  (5.58)  (5.34)</span>
<span class="co">#&gt;         196.00        591.17      129.34  108.00  395.17  412.31</span>
<span class="co">#&gt;         (2.98)       (44.55)     (24.77) (10.50) (42.67) (41.65)</span></code></pre></div>
</div>
<div id="meta-analysis-draft-structure" class="section level2">
<h2 class="hasAnchor">
<a href="#meta-analysis-draft-structure" class="anchor"></a>Meta-analysis Draft structure</h2>
<ol>
<li><p>Get all estimates produced for each of the studies (depending on the design) in a single data frame that will include estimator and standard error for each estimator (or potentially for each sampling-estimator pair)</p></li>
<li>
<p>Then we can <em>feed</em> this data frame into Stan model akin the one below</p>
<ol>
<li>Use the data frame to produce observed estimator vectors for each estimator/sampling-estimator pair, <code>observed*</code>
</li>
<li>Use the data frame produced by study designs to produce arrays of observed estimates and corresponding standard errors (with dummy value where missing), <code>est*</code> and <code>est*_sd</code>
</li>
<li>Assume that deviation from true parameter of interest (<code>error</code>) is driven by use of estimator</li>
</ol>
</li>
<li><p>We then declare the relevant estimands and run diagnosis</p></li>
</ol>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stan_model_meta</span> <span class="op">&lt;-</span> <span class="st">[1314 chars quoted with '"']</span>

<span class="va">get_meta_estimands</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>inquiry_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"prevalence_"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">N</span><span class="op">)</span><span class="op">)</span>,
             estimand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
             stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">get_meta_estimators</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="va">stan_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,
                    K <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  
  <span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">stan_data</span><span class="op">$</span><span class="va">K</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">stan_data</span><span class="op">[[</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"observed"</span>,<span class="va">k</span><span class="op">)</span> <span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> 
      <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">k</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
    <span class="va">stan_data</span><span class="op">[[</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"N"</span>,<span class="va">k</span><span class="op">)</span> <span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> 
      <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">stan_data</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"observed"</span>,<span class="va">k</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
    <span class="va">stan_data</span><span class="op">[[</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"est"</span>,<span class="va">k</span><span class="op">)</span> <span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> 
      <span class="va">data</span><span class="op">[</span><span class="va">stan_data</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"observed"</span>,<span class="va">k</span><span class="op">)</span><span class="op">]</span><span class="op">]</span>,<span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">k</span><span class="op">)</span><span class="op">]</span>
    <span class="va">stan_data</span><span class="op">[[</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"est"</span>,<span class="va">k</span>,<span class="st">"_sd"</span><span class="op">)</span> <span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> 
      <span class="va">data</span><span class="op">[</span><span class="va">stan_data</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"observed"</span>,<span class="va">k</span><span class="op">)</span><span class="op">]</span><span class="op">]</span>,<span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">k</span><span class="op">)</span><span class="op">]</span>
  <span class="op">}</span>
  
  <span class="va">fit</span> <span class="op">&lt;-</span> 
    <span class="fu">rstan</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/rstan/reference/stan.html">stan</a></span><span class="op">(</span>fit <span class="op">=</span> <span class="va">stan_model_meta</span>, 
                data <span class="op">=</span> <span class="va">stan_data</span>, 
                iter <span class="op">=</span> <span class="fl">4000</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="va">extract</span>
  
  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>estimator_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"prev_"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">N</span><span class="op">)</span><span class="op">)</span>,
             estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">alpha</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span>,
             sd <span class="op">=</span>   <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">alpha</span>, <span class="fl">2</span>, <span class="va">sd</span><span class="op">)</span><span class="op">)</span>,
             inquiry_label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"hidden_prev"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">N</span><span class="op">)</span><span class="op">)</span>,
             big_Rhat <span class="op">=</span> <span class="va">big_Rhat</span>
             <span class="op">)</span>
  
  <span class="op">}</span></code></pre></div>
</div>
<div id="meta-declaration" class="section level2">
<h2 class="hasAnchor">
<a href="#meta-declaration" class="anchor"></a>Meta declaration</h2>
<div id="additional-study" class="section level3">
<h3 class="hasAnchor">
<a href="#additional-study" class="anchor"></a>Additional study</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">study_2</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    pop <span class="op">=</span> 
      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        handler <span class="op">=</span> <span class="va">get_study_population</span>,
        network_handler <span class="op">=</span> <span class="va">sim_block_network</span>,
        network_handler_args <span class="op">=</span> 
          <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">5000</span>, K <span class="op">=</span> <span class="fl">3</span>, 
               prev_K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="fl">.5</span>, known <span class="op">=</span> <span class="fl">.2</span>, hidden <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span>, 
               rho_K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.05</span>, <span class="fl">.05</span>, <span class="fl">.05</span><span class="op">)</span>,
               p_edge_within <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span>, 
                                    known <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.05</span><span class="op">)</span>, 
                                    hidden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span>,
               p_edge_between <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="fl">0.05</span>, 
                                     known <span class="op">=</span> <span class="fl">0.1</span>, 
                                     hidden <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>,
               directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,
        
        group_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"frame"</span>, <span class="st">"known"</span>, <span class="st">"hidden"</span><span class="op">)</span>,
        
        <span class="co"># probability of visibility (show-up) for each group</span>
        p_visible <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>frame <span class="op">=</span> <span class="fl">1</span>, known <span class="op">=</span> <span class="fl">1</span>, hidden <span class="op">=</span> <span class="fl">.6</span><span class="op">)</span>,
        
        <span class="co"># probability of service utilization in hidden population</span>
        <span class="co"># for service multiplier</span>
        add_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>p_service <span class="op">=</span> <span class="fl">0.3</span>, 
                          loc_1 <span class="op">=</span> <span class="fl">0.3</span>, loc_2 <span class="op">=</span> <span class="fl">0.1</span>, loc_3 <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>
      <span class="op">)</span>,
    sample <span class="op">=</span> 
      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        rds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">sample_rds</span>,
                   <span class="co"># RDS parameters</span>
                   sampling_variable <span class="op">=</span> <span class="st">"rds"</span>,
                   n_seed <span class="op">=</span> <span class="fl">100</span>,
                   n_coupons <span class="op">=</span> <span class="fl">3</span>,
                   target_type <span class="op">=</span> <span class="st">"waves"</span>,
                   target_n_rds <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,
        pps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">sample_pps</span>,
                   sampling_variable <span class="op">=</span> <span class="st">"pps"</span>,
                   <span class="co"># prop sampling parameters</span>
                   sampling_frame <span class="op">=</span> <span class="st">"frame"</span>,
                   strata <span class="op">=</span> <span class="cn">NULL</span>,
                   cluster <span class="op">=</span> <span class="cn">NULL</span>,
                   target_n_pps <span class="op">=</span> <span class="fl">800</span><span class="op">)</span>
      <span class="op">)</span>,
    inquiries <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">get_study_estimands</span>,
                     known_pattern <span class="op">=</span> <span class="st">"^known"</span>, 
                     hidden_pattern <span class="op">=</span> <span class="st">"^hidden$"</span><span class="op">)</span>,
    estimators <span class="op">=</span> 
      <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        rds <span class="op">=</span> 
          <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>sspse <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">get_study_est_sspse</span>, 
                            label <span class="op">=</span> <span class="st">"rds_sspse"</span>,
                            prior_mean <span class="op">=</span> <span class="fl">450</span>,
                            mcmc_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>interval <span class="op">=</span> <span class="fl">5</span>, burnin <span class="op">=</span> <span class="fl">2000</span>, samplesize <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>,
                            rds_prefix <span class="op">=</span> <span class="st">"rds"</span><span class="op">)</span>,
               chords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">get_study_est_chords</span>, 
                             type <span class="op">=</span> <span class="st">"mle"</span>,
                             label <span class="op">=</span> <span class="st">"rds_chords"</span>,
                             seed_condition <span class="op">=</span> <span class="st">"rds_from == -999"</span>,
                             n_boot <span class="op">=</span> <span class="fl">100</span>,
                             rds_prefix <span class="op">=</span> <span class="st">"rds"</span><span class="op">)</span><span class="op">)</span>,
        pps <span class="op">=</span> 
          <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
            ht <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">get_study_est_ht</span>, 
                      label <span class="op">=</span> <span class="st">"pps_ht"</span><span class="op">)</span>,
            nsum <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">get_study_est_nsum</span>,
                        known <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"frame"</span>, <span class="st">"known"</span><span class="op">)</span>,
                        hidden <span class="op">=</span> <span class="st">"hidden_visible_out"</span>,
                        survey_design <span class="op">=</span> <span class="op">~</span> <span class="va">pps_cluster</span> <span class="op">+</span> <span class="fu">strata</span><span class="op">(</span><span class="va">pps_strata</span><span class="op">)</span>,
                        n_boot <span class="op">=</span> <span class="fl">100</span>,
                        label <span class="op">=</span> <span class="st">"pps_nsum"</span><span class="op">)</span><span class="op">)</span>,
        all <span class="op">=</span> 
          <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>recap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">get_study_est_recapture</span>,
                            capture_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"loc_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>,
                            model <span class="op">=</span> <span class="st">"Mt"</span>,
                            hidden_condition <span class="op">=</span> <span class="st">"hidden == 1"</span>,
                            label <span class="op">=</span> <span class="st">"all_recap"</span><span class="op">)</span>,
               recap2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">get_study_est_recapture</span>,
                             capture_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"rds"</span>, <span class="st">"pps"</span><span class="op">)</span>,
                             model <span class="op">=</span> <span class="st">"Mt"</span>,
                             hidden_condition <span class="op">=</span> <span class="st">"hidden == 1"</span>,
                             label <span class="op">=</span> <span class="st">"samp_recap"</span><span class="op">)</span><span class="op">)</span>
      <span class="op">)</span>
  <span class="op">)</span></code></pre></div>
</div>
<div id="declare-multiple-studies" class="section level3">
<h3 class="hasAnchor">
<a href="#declare-multiple-studies" class="anchor"></a>Declare multiple studies</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">multi_population</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_population.html">declare_population</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">get_multi_populations</span>, 
                     pops_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>study_1 <span class="op">=</span> <span class="va">study_1</span><span class="op">$</span><span class="va">pop</span>,
                                      study_2 <span class="op">=</span> <span class="va">study_2</span><span class="op">$</span><span class="va">pop</span><span class="op">)</span><span class="op">)</span>

<span class="va">multi_sampling</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_sampling.html">declare_sampling</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">get_multi_samples</span>, 
                   samples_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>study_1 <span class="op">=</span> <span class="va">study_1</span><span class="op">$</span><span class="va">sample</span>,
                                       study_2 <span class="op">=</span> <span class="va">study_2</span><span class="op">$</span><span class="va">sample</span><span class="op">)</span><span class="op">)</span> 

<span class="va">multi_inquiry</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_inquiry.html">declare_inquiry</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">get_multi_estimands</span>, 
                  inquiries_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>study_1 <span class="op">=</span> <span class="va">study_1</span><span class="op">$</span><span class="va">inquiries</span>,
                                        study_2 <span class="op">=</span> <span class="va">study_2</span><span class="op">$</span><span class="va">inquiries</span><span class="op">)</span><span class="op">)</span> 

<span class="va">multi_estimators</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/declare_estimator.html">declare_estimator</a></span><span class="op">(</span>handler <span class="op">=</span> <span class="va">get_multi_estimates</span>,
                    estimators_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>study_1 <span class="op">=</span> <span class="va">study_1</span><span class="op">$</span><span class="va">estimators</span>,
                                           study_2 <span class="op">=</span> <span class="va">study_2</span><span class="op">$</span><span class="va">estimators</span><span class="op">)</span><span class="op">)</span>

<span class="va">multi_design</span> <span class="op">&lt;-</span> <span class="va">multi_population</span> <span class="op">+</span> <span class="va">multi_sampling</span> <span class="op">+</span> <span class="va">multi_inquiry</span> <span class="op">+</span> <span class="va">multi_estimators</span>


<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">19872312</span><span class="op">)</span>
<span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/draw_functions.html">draw_data</a></span><span class="op">(</span><span class="va">multi_design</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 2 x 2</span>
<span class="co">#&gt;   study   population           </span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;list&gt;               </span>
<span class="co">#&gt; 1 study_1 &lt;tibble [2,000 × 73]&gt;</span>
<span class="co">#&gt; 2 study_2 &lt;tibble [5,000 × 69]&gt;</span>
<span class="fu">draw_inquiry</span><span class="op">(</span><span class="va">multi_design</span><span class="op">)</span>
<span class="co">#&gt;                   inquiry_label estimand</span>
<span class="co">#&gt; 1           study_1_hidden_size 190.0000</span>
<span class="co">#&gt; 2           study_1_hidden_prev   0.0950</span>
<span class="co">#&gt; 3        study_1_degree_average   4.8170</span>
<span class="co">#&gt; 4 study_1_degree_hidden_average   0.7115</span>
<span class="co">#&gt; 5           study_2_hidden_size 488.0000</span>
<span class="co">#&gt; 6           study_2_hidden_prev   0.0976</span>
<span class="co">#&gt; 7        study_2_degree_average   4.3252</span>
<span class="co">#&gt; 8 study_2_degree_hidden_average   0.2392</span>
<span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/draw_functions.html">draw_estimates</a></span><span class="op">(</span><span class="va">multi_design</span><span class="op">)</span>
<span class="co">#&gt;             estimator_label    estimate           se</span>
<span class="co">#&gt; 1     hidden_size_rds_sspse 183.0000000 7.171208e+01</span>
<span class="co">#&gt; 2    hidden_size_rds_chords 147.0000000 4.814045e+01</span>
<span class="co">#&gt; 3  degree_hidden_rds_chords   6.1632653 6.233803e-01</span>
<span class="co">#&gt; 4     hidden_size_rds_multi 194.2857143 2.818115e+01</span>
<span class="co">#&gt; 5        hidden_size_tls_ht 110.0000000 2.296959e+01</span>
<span class="co">#&gt; 6        hidden_prev_tls_ht   0.0550000 1.148480e-02</span>
<span class="co">#&gt; 7      hidden_size_tls_nsum 482.3374887 6.767643e+01</span>
<span class="co">#&gt; 8           degree_tls_nsum   0.5324749 1.831385e-01</span>
<span class="co">#&gt; 9        hidden_size_pps_ht 195.0000000 3.014279e+01</span>
<span class="co">#&gt; 10       hidden_prev_pps_ht   0.0975000 1.507139e-02</span>
<span class="co">#&gt; 11     hidden_size_pps_nsum 265.6483899 3.360678e+01</span>
<span class="co">#&gt; 12          degree_pps_nsum  37.1267484 4.620739e+00</span>
<span class="co">#&gt; 13    hidden_size_all_recap 208.1144228 1.310946e+01</span>
<span class="co">#&gt; 14   hidden_size_samp_recap 138.3103448 1.126146e+01</span>
<span class="co">#&gt; 15    hidden_size_rds_sspse 333.0000000 1.005618e+02</span>
<span class="co">#&gt; 16   hidden_size_rds_chords  67.0000000 1.133623e+02</span>
<span class="co">#&gt; 17 degree_hidden_rds_chords   3.0000000 9.051586e-01</span>
<span class="co">#&gt; 18       hidden_size_pps_ht 256.8650000 2.710808e+01</span>
<span class="co">#&gt; 19       hidden_prev_pps_ht   0.0513730 5.421615e-03</span>
<span class="co">#&gt; 20     hidden_size_pps_nsum 175.5210595 2.548890e+01</span>
<span class="co">#&gt; 21          degree_pps_nsum  58.4656067 9.342514e+00</span>
<span class="co">#&gt; 22    hidden_size_all_recap 458.0000000 7.842576e+01</span>
<span class="co">#&gt; 23   hidden_size_samp_recap 485.9333333 6.365135e+01</span>
<span class="co">#&gt;                    inquiry_label</span>
<span class="co">#&gt; 1            study_1_hidden_size</span>
<span class="co">#&gt; 2            study_1_hidden_size</span>
<span class="co">#&gt; 3  study_1_degree_hidden_average</span>
<span class="co">#&gt; 4            study_1_hidden_size</span>
<span class="co">#&gt; 5            study_1_hidden_size</span>
<span class="co">#&gt; 6            study_1_hidden_prev</span>
<span class="co">#&gt; 7            study_1_hidden_size</span>
<span class="co">#&gt; 8         study_1_degree_average</span>
<span class="co">#&gt; 9            study_1_hidden_size</span>
<span class="co">#&gt; 10           study_1_hidden_prev</span>
<span class="co">#&gt; 11           study_1_hidden_size</span>
<span class="co">#&gt; 12        study_1_degree_average</span>
<span class="co">#&gt; 13           study_1_hidden_size</span>
<span class="co">#&gt; 14           study_1_hidden_size</span>
<span class="co">#&gt; 15           study_2_hidden_size</span>
<span class="co">#&gt; 16           study_2_hidden_size</span>
<span class="co">#&gt; 17 study_2_degree_hidden_average</span>
<span class="co">#&gt; 18           study_2_hidden_size</span>
<span class="co">#&gt; 19           study_2_hidden_prev</span>
<span class="co">#&gt; 20           study_2_hidden_size</span>
<span class="co">#&gt; 21        study_2_degree_average</span>
<span class="co">#&gt; 22           study_2_hidden_size</span>
<span class="co">#&gt; 23           study_2_hidden_size</span>

<span class="va">multi_simulations</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/simulate_design.html">simulate_design</a></span><span class="op">(</span><span class="va">multi_population</span> <span class="op">+</span>
                    <span class="va">multi_sampling</span> <span class="op">+</span> 
                    <span class="va">multi_inquiry</span> <span class="op">+</span> 
                    <span class="va">multi_estimators</span>, 
                  sims <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>

<span class="fu"><a href="https://declaredesign.org/r/declaredesign/reference/diagnose_design.html">diagnose_design</a></span><span class="op">(</span>simulations_df <span class="op">=</span> <span class="va">multi_simulations</span>, 
                diagnosands <span class="op">=</span> <span class="va">study_diagnosands</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Research design diagnosis based on 10 simulations. Diagnosand estimates with bootstrapped standard errors in parentheses (100 replicates).</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Design Label                 Inquiry Label          Estimator Label N Sims</span>
<span class="co">#&gt;      design_1        study_1_degree_average          degree_pps_nsum     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;      design_1        study_1_degree_average          degree_tls_nsum     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;      design_1 study_1_degree_hidden_average degree_hidden_rds_chords     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;      design_1           study_1_hidden_prev       hidden_prev_pps_ht     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;      design_1           study_1_hidden_prev       hidden_prev_tls_ht     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;      design_1           study_1_hidden_size    hidden_size_all_recap     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;      design_1           study_1_hidden_size       hidden_size_pps_ht     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;      design_1           study_1_hidden_size     hidden_size_pps_nsum     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;      design_1           study_1_hidden_size   hidden_size_rds_chords     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;      design_1           study_1_hidden_size    hidden_size_rds_multi     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;      design_1           study_1_hidden_size    hidden_size_rds_sspse     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;      design_1           study_1_hidden_size   hidden_size_samp_recap     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;      design_1           study_1_hidden_size       hidden_size_tls_ht     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;      design_1           study_1_hidden_size     hidden_size_tls_nsum     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;      design_1        study_2_degree_average          degree_pps_nsum     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;      design_1 study_2_degree_hidden_average degree_hidden_rds_chords     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;      design_1           study_2_hidden_prev       hidden_prev_pps_ht     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;      design_1           study_2_hidden_size    hidden_size_all_recap     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;      design_1           study_2_hidden_size       hidden_size_pps_ht     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;      design_1           study_2_hidden_size     hidden_size_pps_nsum     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;      design_1           study_2_hidden_size   hidden_size_rds_chords     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;      design_1           study_2_hidden_size    hidden_size_rds_sspse     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;      design_1           study_2_hidden_size   hidden_size_samp_recap     10</span>
<span class="co">#&gt;                                                                            </span>
<span class="co">#&gt;  Mean Estimand Mean Estimate SD Estimate Mean Se     Bias     RMSE</span>
<span class="co">#&gt;           4.93         47.08        8.34    6.70    42.15    42.89</span>
<span class="co">#&gt;         (0.03)        (2.55)      (1.86)  (0.53)   (2.55)   (2.63)</span>
<span class="co">#&gt;           4.93          0.46        0.10    0.12    -4.47     4.47</span>
<span class="co">#&gt;         (0.03)        (0.03)      (0.01)  (0.02)   (0.02)   (0.02)</span>
<span class="co">#&gt;           0.77          5.13        0.51    0.70     4.36     4.38</span>
<span class="co">#&gt;         (0.02)        (0.15)      (0.11)  (0.05)   (0.14)   (0.13)</span>
<span class="co">#&gt;           0.10          0.10        0.02    0.01     0.00     0.02</span>
<span class="co">#&gt;         (0.00)        (0.01)      (0.00)  (0.00)   (0.01)   (0.00)</span>
<span class="co">#&gt;           0.10          0.06        0.01    0.01    -0.04     0.04</span>
<span class="co">#&gt;         (0.00)        (0.00)      (0.00)  (0.00)   (0.00)   (0.00)</span>
<span class="co">#&gt;         196.30        200.40       14.82   12.79     4.10    15.43</span>
<span class="co">#&gt;         (3.34)        (4.80)      (2.55)  (0.73)   (4.89)   (3.71)</span>
<span class="co">#&gt;         196.30        199.00       37.77   29.34     2.70    35.33</span>
<span class="co">#&gt;         (3.34)       (11.62)      (5.46)  (0.82)  (11.35)   (4.52)</span>
<span class="co">#&gt;         196.30        219.69       40.04   29.70    23.39    43.29</span>
<span class="co">#&gt;         (3.34)       (12.48)      (7.38)  (1.38)  (11.97)   (9.76)</span>
<span class="co">#&gt;         196.30        154.00       68.69   59.86   -42.30    74.18</span>
<span class="co">#&gt;         (3.34)       (20.69)      (9.83)  (3.47)  (19.46)   (9.37)</span>
<span class="co">#&gt;         196.30        210.77       31.89   35.46    14.47    30.39</span>
<span class="co">#&gt;         (3.34)       (10.18)      (4.75)  (3.30)   (9.08)   (8.01)</span>
<span class="co">#&gt;         196.30        169.35       27.42   61.36   -26.95    40.96</span>
<span class="co">#&gt;         (3.34)        (7.89)      (6.56)  (5.54)   (9.63)   (6.81)</span>
<span class="co">#&gt;         196.30        189.56       22.36   24.87    -6.74    22.31</span>
<span class="co">#&gt;         (3.34)        (6.38)      (5.02)  (2.02)   (6.71)   (3.24)</span>
<span class="co">#&gt;         196.30        122.50       22.39   22.10   -73.80    75.29</span>
<span class="co">#&gt;         (3.34)        (6.40)      (3.28)  (0.55)   (4.52)   (4.29)</span>
<span class="co">#&gt;         196.30        546.89       93.24   82.69   350.59   360.09</span>
<span class="co">#&gt;         (3.34)       (25.67)     (20.00) (13.05)  (23.83)  (25.75)</span>
<span class="co">#&gt;           4.24         49.50       10.52    7.25    45.26    46.35</span>
<span class="co">#&gt;         (0.01)        (2.81)      (2.53)  (0.88)   (2.81)   (3.07)</span>
<span class="co">#&gt;           0.25          1.65        0.81    0.97     1.41     1.60</span>
<span class="co">#&gt;         (0.00)        (0.19)      (0.14)  (0.10)   (0.19)   (0.22)</span>
<span class="co">#&gt;           0.10          0.06        0.00    0.01    -0.04     0.04</span>
<span class="co">#&gt;         (0.00)        (0.00)      (0.00)  (0.00)   (0.00)   (0.00)</span>
<span class="co">#&gt;         503.60        462.94       60.95   89.69   -40.66    71.81</span>
<span class="co">#&gt;         (3.91)       (16.40)     (11.43)  (5.08)  (16.95)  (14.61)</span>
<span class="co">#&gt;         503.60        288.67       19.83   28.18  -214.93   216.26</span>
<span class="co">#&gt;         (3.91)        (5.60)      (2.80)  (0.75)   (7.33)   (7.38)</span>
<span class="co">#&gt;         503.60        209.63       40.27   26.41  -293.97   296.63</span>
<span class="co">#&gt;         (3.91)       (10.89)      (6.25)  (1.13)  (11.34)  (11.52)</span>
<span class="co">#&gt;         503.60        324.80      200.03  151.50  -178.80   260.88</span>
<span class="co">#&gt;         (3.91)       (53.46)     (20.62)  (6.71)  (53.44)  (35.74)</span>
<span class="co">#&gt;         503.60       1374.55      876.77  364.01   870.95  1206.38</span>
<span class="co">#&gt;         (3.91)      (268.79)     (80.64) (88.12) (270.07) (214.06)</span>
<span class="co">#&gt;         503.60        496.45       81.39   61.88    -7.15    86.40</span>
<span class="co">#&gt;         (3.91)       (26.13)     (16.26)  (6.60)  (29.05)  (13.57)</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># meta_population &lt;- </span>
<span class="co">#   declare_estimand(handler = get_meta_population)</span>
<span class="co">#   </span>
<span class="co"># meta_estimands &lt;- </span>
<span class="co">#   declare_estimand(handler = get_meta_estimands)</span>
<span class="co"># </span>
<span class="co"># meta_estimators &lt;- </span>
<span class="co">#   declare_estimator(handler = get_meta_estimators)</span>
<span class="co"># </span>

<span class="va">meta_design</span> <span class="op">&lt;-</span> <span class="va">meta_population</span> <span class="op">+</span> <span class="va">meta_inquiry</span> <span class="op">+</span> <span class="va">meta_estimators</span>
 </code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Georgiy Syunyaev <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Georgiy Syunyaev.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
